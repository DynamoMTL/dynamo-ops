---
box: mwallasch/docker-ruby-node
build:
    steps:
        - bundle-install
        - npm-install
        - npm-test
        - script:
          name: bower install
          code: node node_modules/bower/bin/bower install --allow-root
        - script:
          name: generate production site
          code: |-
            node node_modules/gulp/bin/gulp build-prod
            ls -l ./_production
        - script:
          name: jekyll doctor
          code: bundle exec jekyll doctor

deploy :
  steps :
     - gh-pages:
      token: $GIT_TOKEN
      domain: dynamomtl.github.io/dynamo-ops
      basedir: _production
